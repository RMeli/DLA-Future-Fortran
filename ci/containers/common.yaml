#
# Distributed Linear Algebra with Future (DLAF)
#
# Copyright (c) ETH Zurich
# All rights reserved.
#
# Please, refer to the LICENSE file in the root directory.
# SPDX-License-Identifier: BSD-3-Clause
#

packages:
  all:
    target: [x86_64]
    require:
      - "platform=linux"
      - "os=ubuntu24.04"
  blas:
    require: 'intel-oneapi-mkl'
  lapack:
    require: 'intel-oneapi-mkl'
  scalapack:
    require: 'intel-oneapi-mkl'
  intel-oneapi-mkl:
    require:
      - 'threads=none'
      - '+cluster'
      - '+gfortran'
  openblas:
    variants:
      - 'threads=openmp'
  hwloc:
    variants:
      - '~libxml2'
  dla-future:
    require:
      - '@0.10.0'
  git:
    # Force git as non-buildable to allow deprecated versions in environments
    # https://github.com/spack/spack/pull/30040
    buildable: false
  # FIXME: Workaround until CE provides a full MPI replacement (as SARUS did)
  mpi:
    require: 'cray-mpich'
  # FIXME: Workaround until CE provides a full MPI replacement (as SARUS did)
  libfabric:
    # Specify libfabric version to match the system version
    require: '@1.22.0'
  xpmem:
    require:
      - '~kernel-module'
  cray-gtl:
    buildable: True
  cray-mpich:
    buildable: True
  cray-pals:
    buildable: True
  cray-pmi:
    buildable: True
